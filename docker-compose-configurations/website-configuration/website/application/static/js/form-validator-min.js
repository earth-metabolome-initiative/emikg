var translations={};function get_translation(t){if(t in translations)return translations[t];var a="/"+$("html").attr("lang")+"/translation/"+t;return $.ajax({url:a,async:!1}).responseText}function form_is_valid(t){var a=!0;return t.find(".validate").each((function(){$(this).hasClass("valid")||(a=!1)})),a}function show_error_message(t,a){var r=get_translation(a),e=$("<p></p>");e.addClass("error-message"),e.attr("for",t.attr("name")),e.text(r),t.parent("p").after(e),t.addClass("error")}function check_not_empty(t){if(null!=t.attr("empty"))return!0;var a=t.val();return""!=(a=a.trim())||(show_error_message(t,"empty_input_field"),!1)}function check_must_be_equal_to(t){if(null!=t.attr("must_be_equal_to")&&t.val()!=t.attr("must_be_equal_to"))return show_error_message(t,"must_be_equal_to"),!1;return!0}function validation_callback(t){$('p.error-message[for="'+t.attr("name")+'"]').remove(),t.removeClass("error"),t.removeClass("valid"),check_not_empty(t)&&check_must_be_equal_to(t)&&t.addClass("valid"),t.parents("form").find('button[type="submit"]').prop("disabled",!form_is_valid(t.parents("form")))}$(document).ready((function(){$(".validate").blur((function(){validation_callback($(this))})),$(".validate").keyup((function(){var t=$(this),a=null;a&&clearTimeout(a),a=setTimeout((function(){validation_callback(t)}),300)})),$("form").each((function(){var t=$(this);form_is_valid(t)||t.find('button[type="submit"]').prop("disabled",!0)})),$("form").submit((function(t){if(t.preventDefault(),form_is_valid($(this))){var a=$(this),r=a.attr("action"),e=a.attr("method"),n=a.serialize();$.ajax({url:r,method:e,data:n,success:function(t){if(a.find("input").val(""),a.find("textarea").val(""),"redirect_url"in t){var r=t.redirect_url;window.location.replace(r)}},error:function(t){for(var r=t.errors,e=0;e<r;e++){var n=r[e];show_error_message(a.find('input[name="'+n.field+'"]'),n.message)}}})}}))}));