function create_search_result(e,t){var a=$("<li></li>"),n=$("<a></a>"),r=$("<h4></h4>"),c=$("<span></span>");return n.attr("href",t.url),n.text(t.name),r.append(n),c.text(t.description),a.append(r),a.append(c),a}function autocomplete_search(){$("ul.autocomplete-search").each((function(){var e=$(this);e.hide();var t=e.attr("for"),a=e.attr("action"),n="/autocomplete-"+a+"/",r=e.attr("method"),c=$('input[name="'+t+'"]'),i=null;c.keyup((function(){i&&clearTimeout(i),i=setTimeout((function(){var t=c.val();if(t.length<=2)return e.empty(),void e.hide(300);var i=$("<span></span>");i.addClass("loader"),$.ajax({url:n,method:r,data:{search:t},success:function(t){e.empty();for(var n=0;n<t.matching_results.length;n++){var r=create_search_result(a,t.matching_results[n]);r.click((function(){c.val($(this).find("a").text()),c.trigger("keyup"),e.hide(300)})),e.append(r)}t.matching_results.length>0?e.show(300):e.hide(300)},complete:function(){i.remove()}})}),50)}))}))}$(document).ready(autocomplete_search);